KERNEL_PLATFORM_SRC_DIR := $(GET_LOCAL_DIR)
KERNEL_PLATFORM_OUT_DIR := $(KERNEL_OUT_DIR)/platform
$(shell mkdir -p $(KERNEL_PLATFORM_OUT_DIR))

KERNEL_PLATFORM_PC_O_FILES += \
	machine.o \
	pit.o \
	pic.o \
	nvram.o \
	timer.o \
	vm.o

KERNEL_PLATFORM_PC_O_FILES := $(addprefix $(KERNEL_PLATFORM_OUT_DIR)/,$(KERNEL_PLATFORM_PC_O_FILES))

KERNEL_O_FILES += $(KERNEL_PLATFORM_PC_O_FILES)

$(KERNEL_PLATFORM_OUT_DIR)/%.o: $(KERNEL_PLATFORM_SRC_DIR)/%.c
	$(CC) -c $< $(GLOBAL_CFLAGS) $(KERNEL_CFLAGS) $(INCLUDES) -o $@
